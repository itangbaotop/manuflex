server:
  port: 8085

spring:
  application:
    name: platform-workflow-service
  datasource:
    url: jdbc:mysql://localhost:3306/camunda_bpm?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Shanghai
    username: manuflex_user
    password: manuflex_password
    driver-class-name: com.mysql.cj.jdbc.Driver

## Camunda BPM 配置
camunda.bpm:
  # 启用 Camunda REST API
  rest:
    enabled: true
  # 启用 Camunda Webapp (Admin/Cockpit/Tasklist)
  webapp:
    enabled: true
  # 数据库配置 (Camunda 会使用 Spring 的数据源配置)
  database:
    type: mysql
    schema-update: true # 首次启动时自动创建 Camunda 的表结构，生产环境请谨慎或设置为 false
  # 禁用 Camunda Webapp 自己的 Spring Security 集成
  # ⚠️ Camunda 7.15+ 默认禁用，但为了明确，可以显式配置
  # webapp.security.enabled: false # 这个配置在 Camunda 7.15+ 已经移除，不需要了
  generic-properties:
    properties:
      # 禁用 Camunda 内部的授权检查，我们通过 Spring Security 统一管理
      authorization-enabled: false
      # 允许匿名用户访问 Camunda REST API (如果不需要认证的话)，但我们通过 Gateway 和 Spring Security 控制
      allow-anonymous-user: true # 如果设置为 false，则需要 Camunda 内部用户认证
      # 更多 Camunda 配置可以在这里添加

logging:
  level:
    root: INFO
    org.springframework.web: INFO
    top.itangbao.platform.workflow: DEBUG
    org.camunda.bpm: INFO
    org.springframework.jdbc: DEBUG

springdoc:
  swagger-ui:
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: method
  api-docs:
    path: /v3/api-docs
  info:
    title: ManuFlex PaaS - Workflow Service API
    description: Workflow Management Service APIs for ManuFlex PaaS.
    version: 1.0.0
    contact:
      name: itangbao
      email: itangbao@example.com
    license:
      name: Apache 2.0
      url: https://www.apache.org/licenses/LICENSE-2020.html

app: # JWT 配置 (LIMS 也需要 JwtTokenProvider)
  jwtSecret: xi5G429vyD9/rLxktYqsZU723o3V5OB65KWoU76ORtFqihOS3gSQSqEWfDzDdc1ThsPv9D2v0AdqvcdXg+2vqg==
  jwtExpirationMs: 3600000
  jwtRefreshExpirationMs: 604800000
