spring:
  application:
    name: platform-iam-service # åº”ç”¨åç§°ï¼Œä¸ application.yml ä¸­çš„ä¸€è‡´
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848 # Nacos Server åœ°å€ (Docker Compose ä¸­ nacos æœåŠ¡å)
        namespace: # å‘½åç©ºé—´ID (å¯é€‰ï¼Œå¦‚æœä½¿ç”¨é»˜è®¤å‘½åç©ºé—´å¯ä»¥ç•™ç©º)
      config:
        server-addr: localhost:8848 # Nacos Server åœ°å€
        file-extension: yml # é…ç½®æ–‡ä»¶çš„æ‰©å±•å
        group: DEFAULT_GROUP # é…ç½®ç»„
        namespace: # å‘½åç©ºé—´ID (å¯é€‰)
        refresh-enabled: true # å¯ç”¨åŠ¨æ€åˆ·æ–°é…ç½®
    sentinel: #  Sentinel é…ç½®
      transport:
        dashboard: localhost:8858 # Sentinel æ§åˆ¶å°åœ°å€ (é€šå¸¸æ˜¯ç‹¬ç«‹éƒ¨ç½²çš„ Sentinel Dashboard)
        port: 8719 # Sentinel å®¢æˆ·ç«¯æš´éœ²çš„ç«¯å£ï¼Œç”¨äºå’Œ Dashboard é€šä¿¡
      datasource: # é…ç½® Sentinel è§„åˆ™æŒä¹…åŒ–åˆ° Nacos (å¯é€‰ï¼Œä½†æ¨è)
        flow:
          nacos:
            server-addr: localhost:8848
            group-id: DEFAULT_GROUP
            data-id: ${spring.application.name}-flow-rules
            data-type: json
            rule-type: flow

  config:
    import:
      # âš ï¸ å…³é”®ä¿®æ­£ï¼šæ˜¾å¼æŒ‡å®š DataIdã€‚é»˜è®¤ DataId ä¸º ${åº”ç”¨å}.yml
      # æ ¼å¼ä¸º: nacos:[dataId]?[group]&[refresh]
      - nacos:${spring.application.name}.${spring.cloud.nacos.config.file-extension}

seata:
  # å®¢æˆ·ç«¯è¡Œä¸ºé…ç½®
  client:
    rm:
      async-commit-buffer-limit: 10000
      lock:
        retry-interval: 10
        retry-times: 30
      report:
        success: false
        fail: true
      rpc-request-timeout: 30000
    tm:
      commit-retry-count: 5
      rollback-retry-count: 5
      rpc-request-timeout: 30000

  # é…ç½®ä¸­å¿ƒï¼šè¯»å– seata-client.properties
  config:
    type: nacos
    nacos:
      server-addr: localhost:8848 # â¬…ï¸ ã€ä¿®æ­£ç‚¹3ã€‘ç»Ÿä¸€ä½¿ç”¨ localhostï¼Œä¸è¦ç”¨ nacos
      group: SEATA_GROUP
      namespace: "" # â¬…ï¸ ã€ä¿®æ­£ç‚¹4ã€‘å¿…é¡»ç•™ç©ºï¼Œä¸è¦å†™ public
      data-id: seata-client.properties

  # ğŸ‘‡ ã€é‡è¦é—æ¼ã€‘ï¼šæ‚¨å¿…é¡»é…ç½®æ³¨å†Œä¸­å¿ƒï¼Œå¦åˆ™ Client æ‰¾ä¸åˆ° Server
  registry:
    type: nacos
    nacos:
      application: seata-server # Seata Server çš„æœåŠ¡å
      server-addr: localhost:8848
      group: SEATA_GROUP # å¿…é¡»ä¸ Seata Server ç«¯çš„ Group ä¸€è‡´
      namespace: ""
  tx-service-group: manuflex_tx_group


# =================================================
# ğŸ‘‡ Zipkin ä¸ Tracing æ ¸å¿ƒé…ç½®
# =================================================
management:
  tracing:
    sampling:
      probability: 1.0 # é‡‡æ ·ç‡ï¼š1.0 = 100% é‡‡é›†ï¼ˆå¼€å‘ç¯å¢ƒï¼‰ï¼›ç”Ÿäº§ç¯å¢ƒå»ºè®® 0.1
  zipkin:
    tracing:
      # Zipkin æœåŠ¡å™¨åœ°å€
      # å¦‚æœ Zipkin è·‘åœ¨ Docker ä¸”æ˜ å°„äº†ç«¯å£ï¼Œæœ¬åœ°å¼€å‘å†™ localhost:9411
      endpoint: http://localhost:9411/api/v2/spans