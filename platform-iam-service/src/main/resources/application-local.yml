server:
  port: 8081 # IAM æœåŠ¡çš„ç«¯å£ï¼Œä¸å…¶ä»–æœåŠ¡åŒºåˆ†å¼€

spring:
  application:
    name: platform-iam-service
  datasource:
    url: jdbc:mysql://localhost:3306/manuflex_paas?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Shanghai
    username: manuflex_user
    password: manuflex_password
    driver-class-name: com.mysql.cj.jdbc.Driver
  jpa:
    hibernate:
      ddl-auto: update # å¯åŠ¨æ—¶è‡ªåŠ¨æ›´æ–°æ•°æ®åº“ schemaï¼Œå¼€å‘ç¯å¢ƒæ¨èï¼Œç”Ÿäº§ç¯å¢ƒè¯·è°¨æ…ä½¿ç”¨æˆ–è®¾ä¸º none
    show-sql: true # åœ¨æ§åˆ¶å°æ‰“å° SQL è¯­å¥
    properties:
      hibernate:
        format_sql: true # æ ¼å¼åŒ– SQL è¯­å¥
  data:
    redis:
      host: redis
      port: 6379
      database: 0
      timeout: 5000ms

metadata:
  service:
#    url: http://localhost:8082 # Metadata Service çš„å®é™…åœ°å€
    url: http://platform-metadata-service

springdoc:
  swagger-ui:
    path: /swagger-ui.html # è‡ªå®šä¹‰ Swagger UI çš„è®¿é—®è·¯å¾„ï¼Œé»˜è®¤ä¸º /swagger-ui/index.html
    tags-sorter: alpha # æŒ‰å­—æ¯é¡ºåºæ’åºæ ‡ç­¾
    operations-sorter: method # æŒ‰ HTTP æ–¹æ³•æ’åºæ“ä½œ
  api-docs:
    path: /v3/api-docs # OpenAPI 3.0 JSON æ–‡æ¡£çš„è·¯å¾„ï¼Œé»˜è®¤ä¸º /v3/api-docs
  # è‡ªå®šä¹‰ OpenAPI æ–‡æ¡£ä¿¡æ¯
  info:
    title: ManuFlex PaaS - IAM Service API
    description: Identity and Access Management (IAM) Service APIs for ManuFlex PaaS.
    version: 1.0.0
    contact:
      name: itangbao
      email: itangbao@example.com
    license:
      name: Apache 2.0
      url: https://www.apache.org/licenses/LICENSE-2.0.html
  # é…ç½® Spring Security è®¤è¯ä¿¡æ¯ (JWT) - ç¨åé›†æˆ JWT æ—¶ä¼šç”¨åˆ°
  # security:
  #   oauth2:
  #     authorization-url: /oauth2/authorization
  #     token-url: /oauth2/token
  #     flows:
  #       password:
  #         token-url: /oauth2/token

#jwté…ç½®
app:
  jwtSecret: xi5G429vyD9/rLxktYqsZU723o3V5OB65KWoU76ORtFqihOS3gSQSqEWfDzDdc1ThsPv9D2v0AdqvcdXg+2vqg==
  jwtExpirationMs: 3600000 # Access Token è¿‡æœŸæ—¶é—´ï¼Œä¾‹å¦‚ 1 å°æ—¶ (3600 * 1000 æ¯«ç§’)
  jwtRefreshExpirationMs: 604800000 # Refresh Token è¿‡æœŸæ—¶é—´ï¼Œä¾‹å¦‚ 7 å¤© (7 * 24 * 3600 * 1000 æ¯«ç§’)

logging:
  file:
    # â¬…ï¸ ç¡®ä¿è¿™æ˜¯ Promtail æ˜ å°„çš„ä¸»æœºè·¯å¾„
    name: ./logs/iam/application.log
  level:
    root: INFO
    org.springframework.web: INFO
    top.itangbao.platform.iam: DEBUG # è°ƒæ•´ä¸ºæ‚¨æœåŠ¡çš„åŒ…åï¼Œæ–¹ä¾¿è°ƒè¯•
    org.hibernate.SQL: DEBUG # æ‰“å° Hibernate ç”Ÿæˆçš„ SQL è¯­å¥
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE # æ‰“å° SQL å‚æ•°

# Seata åŸºç¡€å¼•å¯¼é…ç½®
seata:
  # å®¢æˆ·ç«¯è¡Œä¸ºé…ç½®
  client:
    rm:
      async-commit-buffer-limit: 10000
      lock:
        retry-interval: 10
        retry-times: 30
      report:
        success: false
        fail: true
      rpc-request-timeout: 30000
    tm:
      commit-retry-count: 5
      rollback-retry-count: 5
      rpc-request-timeout: 30000

  # é…ç½®ä¸­å¿ƒï¼šè¯»å– seata-client.properties
  config:
    type: nacos
    nacos:
      server-addr: localhost:8848 # â¬…ï¸ ã€ä¿®æ­£ç‚¹3ã€‘ç»Ÿä¸€ä½¿ç”¨ localhostï¼Œä¸è¦ç”¨ nacos
      group: SEATA_GROUP
      namespace:
      data-id: seata-client.properties

  # ğŸ‘‡ ã€é‡è¦é—æ¼ã€‘ï¼šæ‚¨å¿…é¡»é…ç½®æ³¨å†Œä¸­å¿ƒï¼Œå¦åˆ™ Client æ‰¾ä¸åˆ° Server
  registry:
    type: nacos
    nacos:
      application: seata-server # Seata Server çš„æœåŠ¡å
      server-addr: localhost:8848
      group: SEATA_GROUP # å¿…é¡»ä¸ Seata Server ç«¯çš„ Group ä¸€è‡´
      namespace:
  tx-service-group: manuflex_tx_group

management:
  endpoints:
    web:
      exposure:
        include: 'health,info,prometheus,metrics' # æš´éœ²ç»™ Prometheus
  tracing:
    sampling:
      probability: 1.0 # é‡‡æ ·ç‡ 100%
  zipkin:
    tracing:
      endpoint: http://localhost:9411/api/v2/spans # å‘é€ç»™ Zipkin
  observations:
    key-values:
      application: ${spring.application.name}