server:
  port: 8081 # IAM æœåŠ¡çš„ç«¯å£ï¼Œä¸å…¶ä»–æœåŠ¡åŒºåˆ†å¼€

spring:
  application:
    name: platform-iam-service
  datasource:
    url: jdbc:mysql://localhost:3306/manuflex_paas?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Shanghai
    username: manuflex_user
    password: manuflex_password
    driver-class-name: com.mysql.cj.jdbc.Driver
  jpa:
    hibernate:
      ddl-auto: update # å¯åŠ¨æ—¶è‡ªåŠ¨æ›´æ–°æ•°æ®åº“ schemaï¼Œå¼€å‘ç¯å¢ƒæ¨èï¼Œç”Ÿäº§ç¯å¢ƒè¯·è°¨æ…ä½¿ç”¨æˆ–è®¾ä¸º none
    show-sql: true # åœ¨æ§åˆ¶å°æ‰“å° SQL è¯­å¥
    properties:
      hibernate:
        format_sql: true # æ ¼å¼åŒ– SQL è¯­å¥
  data:
    redis:
      host: redis
      port: 6379
      database: 0
      timeout: 5000ms

metadata:
  service:
#    url: http://localhost:8082 # Metadata Service çš„å®é™…åœ°å€
    url: http://platform-metadata-service

springdoc:
  swagger-ui:
    path: /swagger-ui.html # è‡ªå®šä¹‰ Swagger UI çš„è®¿é—®è·¯å¾„ï¼Œé»˜è®¤ä¸º /swagger-ui/index.html
    tags-sorter: alpha # æŒ‰å­—æ¯é¡ºåºæ’åºæ ‡ç­¾
    operations-sorter: method # æŒ‰ HTTP æ–¹æ³•æ’åºæ“ä½œ
  api-docs:
    path: /v3/api-docs # OpenAPI 3.0 JSON æ–‡æ¡£çš„è·¯å¾„ï¼Œé»˜è®¤ä¸º /v3/api-docs
  # è‡ªå®šä¹‰ OpenAPI æ–‡æ¡£ä¿¡æ¯
  info:
    title: ManuFlex PaaS - IAM Service API
    description: Identity and Access Management (IAM) Service APIs for ManuFlex PaaS.
    version: 1.0.0
    contact:
      name: itangbao
      email: itangbao@example.com
    license:
      name: Apache 2.0
      url: https://www.apache.org/licenses/LICENSE-2.0.html
  # é…ç½® Spring Security è®¤è¯ä¿¡æ¯ (JWT) - ç¨åé›†æˆ JWT æ—¶ä¼šç”¨åˆ°
  # security:
  #   oauth2:
  #     authorization-url: /oauth2/authorization
  #     token-url: /oauth2/token
  #     flows:
  #       password:
  #         token-url: /oauth2/token

app:
  jwt:
    # å…¬é’¥ï¼ˆç½‘å…³å’Œæ‰€æœ‰èµ„æºæœåŠ¡éƒ½éœ€è¦é…ç½®ï¼‰
    privateKey: MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC4E8xhi5OUlZVqNxaSD0WQZCDs/GmJ3S0cmXx0b6u4QJxrxPhZXzt7sO83g5nFRuieCng/gqAbXEcZezAxX0SkrYac7HYFsdOH7JTe4jYm5yk5lAve5ZwpD5xkiAwgdYOtD/rrS57IvDHENejK1lophb84bNQQBnG0HIu6E7oxZfIyB+LxGg005k7EWbKTUbn2EXowupwL7iPjnagJrrCjP0et+ErcMDC4EV9B6sz95gu9KHHmn3b/Eqx5LBrePpa97XMBjdkf/C/9Nd1AnXzKRqpeTDqqf0QvOHoeDYAJMO72TuGzrsz0lYoiRBl7oOs4E2NUPllGgSQD66VmJl61AgMBAAECggEAEuiVuf9obX7gFkUKYH6JGsfuSemzvaGmnKV3j05ZSVf5uWhGSofpyE7og79U8FrUUkepCn0UjTrxYsCwtqGen3vjtALmLLeTjwbSVALQpTZhmbSHc6IKZH1iB0GiXUM0/3YAxGLEMMKEKi+PdiaGpHVEqzsinXLMA0BbagXUvnYZamZvPf3Zz4sy8X5JCP31dZtDHzLh3BAocfQh0dDYNFRfLCk+zRBkvrTsOqS6uJ0W/vMR0Tg9q4iwVKhgi4BOs7UCnN9TH/KgbVR6ieS6HZmAR1dKY6WA1QWm2UPM0zLOcjgFwyET7Xc59WxwOAWhDQUVJ5OjXIWyyS3t1R85AQKBgQD3rnLB+Ka7xXZLiwvlboICTGJIfRRb3rmm4+iI0JmNBOPmgXYRkT9KqeocSJxTNdBUMsHZhZyjjkvr0C8DzeOyZ5rtd05nK33uefm8+dwhbeEOlgLXIo0znAVkI43zzTKyR2y/CQW3bTxMet9O1Mw86yis1EL3Oi03CNLNmvoGxQKBgQC+QnxFw8dxLFGl9FoGqymFVMen8wC3Kord9tz7tRo76VMvQwFGSUxmUVKASlgop/84OT95Vm/uOGf+XYP3ICRaX5ypq6Nhjg6X6ZHrtV3ghS1Bs52+YXdLWGQR6apc92fj9uOoQDpiZjiPKOZTiFaxi88ZMZ2Saa7C46UgFOf3MQKBgEW1Xm0DW4HrkGCwkLeRA5w7/UljkrBMnjm/WTnwY9cRska01xMYqxSLf+1X7k9pDOo1ouNivHQ331xOKn1KnDQg/rSo6HMXBYlx4Pzz4aWy9C2TwNblzZHh7o6Bhzk/3m3Ytl2J34cBgoAP8PuR3q2ijb8eun40bHdZz2K4pHf1AoGBAIlNM5+pJMIAiL+pslpDpUgqIZeLX0XP9r0uTNV9IXyA6l4eDcpqVS81msMoY6ybaCxr6+mlvkr8+9duJzDtSi7J9yXezp41RUTN81dV4HSJx1o1xC3C6rM+C6F9rks+5AN4hVxDVZ7zQ/fUPTulFWM1kPQOgTdK+yp73Atl6uzRAoGBAJc11watjj+qbNBDml8u2RU1i6wb8oHGszxHbmEpWgxcbPY59mBN/cro/IY+/HeJoGXG0iY664pfgy1yk+UqSD4U0iF5RGYKVWwDvKz2UA8PSKBCX1luApa87OVLigBvUBghVSWOfZHhbNVkPXttM3/3FyDm6jkQCwl5bteKSnC8
    publicKey: MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuBPMYYuTlJWVajcWkg9FkGQg7Pxpid0tHJl8dG+ruECca8T4WV87e7DvN4OZxUbongp4P4KgG1xHGXswMV9EpK2GnOx2BbHTh+yU3uI2JucpOZQL3uWcKQ+cZIgMIHWDrQ/660ueyLwxxDXoytZaKYW/OGzUEAZxtByLuhO6MWXyMgfi8RoNNOZOxFmyk1G59hF6MLqcC+4j452oCa6woz9HrfhK3DAwuBFfQerM/eYLvShx5p92/xKseSwa3j6Wve1zAY3ZH/wv/TXdQJ18ykaqXkw6qn9ELzh6Hg2ACTDu9k7hs67M9JWKIkQZe6DrOBNjVD5ZRoEkA+ulZiZetQIDAQAB
    expirationMs: 3600000 # Access Token è¿‡æœŸæ—¶é—´ï¼Œä¾‹å¦‚ 1 å°æ—¶ (3600 * 1000 æ¯«ç§’)
    refreshExpirationMs: 86400000 # Refresh Token è¿‡æœŸæ—¶é—´ï¼Œä¾‹å¦‚ 7 å¤© (7 * 24 * 3600 * 1000 æ¯«ç§’)

logging:
  file:
    # ç¡®ä¿è¿™æ˜¯ Promtail æ˜ å°„çš„ä¸»æœºè·¯å¾„
    name: ./logs/iam/application.log
  level:
    root: INFO
    org.springframework.web: INFO
    top.itangbao.platform.iam: DEBUG # è°ƒæ•´ä¸ºæ‚¨æœåŠ¡çš„åŒ…åï¼Œæ–¹ä¾¿è°ƒè¯•
    org.hibernate.SQL: DEBUG # æ‰“å° Hibernate ç”Ÿæˆçš„ SQL è¯­å¥
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE # æ‰“å° SQL å‚æ•°

# Seata åŸºç¡€å¼•å¯¼é…ç½®
seata:
  # å®¢æˆ·ç«¯è¡Œä¸ºé…ç½®
  client:
    rm:
      async-commit-buffer-limit: 10000
      lock:
        retry-interval: 10
        retry-times: 30
      report:
        success: false
        fail: true
      rpc-request-timeout: 30000
    tm:
      commit-retry-count: 5
      rollback-retry-count: 5
      rpc-request-timeout: 30000

  # é…ç½®ä¸­å¿ƒï¼šè¯»å– seata-client.properties
  config:
    type: nacos
    nacos:
      server-addr: localhost:8848 #  ã€ä¿®æ­£ç‚¹3ã€‘ç»Ÿä¸€ä½¿ç”¨ localhostï¼Œä¸è¦ç”¨ nacos
      group: SEATA_GROUP
      namespace:
      data-id: seata-client.properties

  # ğŸ‘‡ ã€é‡è¦é—æ¼ã€‘ï¼šæ‚¨å¿…é¡»é…ç½®æ³¨å†Œä¸­å¿ƒï¼Œå¦åˆ™ Client æ‰¾ä¸åˆ° Server
  registry:
    type: nacos
    nacos:
      application: seata-server # Seata Server çš„æœåŠ¡å
      server-addr: localhost:8848
      group: SEATA_GROUP # å¿…é¡»ä¸ Seata Server ç«¯çš„ Group ä¸€è‡´
      namespace:
  tx-service-group: manuflex_tx_group

management:
  endpoints:
    web:
      exposure:
        include: 'health,info,prometheus,metrics' # æš´éœ²ç»™ Prometheus
  tracing:
    sampling:
      probability: 1.0 # é‡‡æ ·ç‡ 100%
  zipkin:
    tracing:
      endpoint: http://localhost:9411/api/v2/spans # å‘é€ç»™ Zipkin
  observations:
    key-values:
      application: ${spring.application.name}